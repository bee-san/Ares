From d10869ebc9f5638435c678210ee05614d5b15656 Mon Sep 17 00:00:00 2001
From: Ren Trieu <ren.trieu.github@gmail.com>
Date: Wed, 9 Apr 2025 17:07:07 -0700
Subject: [PATCH] Example for exiting the search on human checker success

Signed-off-by: Ren Trieu <ren.trieu.github@gmail.com>
---
 src/searchers/astar.rs | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)

diff --git a/src/searchers/astar.rs b/src/searchers/astar.rs
index 02d4a1c..a3e1df2 100644
--- a/src/searchers/astar.rs
+++ b/src/searchers/astar.rs
@@ -376,6 +376,26 @@ fn expand_node(
             let athena_checker = Checker::<Athena>::new();
             let checker = CheckerTypes::CheckAthena(athena_checker);
             let result = decoder.crack(&current_node.state.text[0], &checker);
+            if result.success {
+                let mut decoders_used = current_node.state.path.clone();
+                let text = result.unencrypted_text.clone().unwrap_or_default();
+                debug!("DEBUG: Found successful result with decoder: {} -> {:?}", result.decoder, text);
+                decoders_used.push(result.clone());
+
+                // Create a special "result" node with a very low total_cost to ensure it's processed first
+                let result_node = AStarNode {
+                    state: DecoderResult {
+                        text: text.clone(),
+                        path: decoders_used,
+                    },
+                    cost: current_node.cost + 1,
+                    heuristic: -1000.0, // Very negative to ensure highest priority
+                    total_cost: -1000.0, // Very negative to ensure highest priority
+                    next_decoder_name: Some("__RESULT__".to_string()), // Special marker
+                };
+
+                new_nodes.push(result_node);
+            }
 
             // Process the result
             if let Some(decoded_text) = &result.unencrypted_text {
-- 
2.39.0

